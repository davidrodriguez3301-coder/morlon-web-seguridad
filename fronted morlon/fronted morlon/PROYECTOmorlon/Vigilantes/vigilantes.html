<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gestión de Vigilantes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <link rel="stylesheet" href="../css/estilos.css" />
</head>

<body class="body-main">
  <!-- ENCABEZADO -->
  <div class="container text-center mt-3">
    <div class="row w-100 align-items-center">
      <div class="col-3 text-start">
        <a class="navbar-brand" href="../PrincipalIndex/index.html">
          <img src="../assets/img/LOGO.JPG" alt="Logo Morlon" style="height: 60px; border-radius: 50%" />
        </a>
      </div>
      <div class="col-6">
        <h1 class="bienvenidos">Gestión de Vigilantes</h1>
      </div>
      <div class="col-3 text-end">
        <a class="nav-link text-black" href="../PrincipalIndex/index.html">
          Volver <i class="fas fa-arrow-left ms-1"></i>
        </a>
      </div>
    </div>
  </div>

  <!-- CONTENIDO -->
  <main class="container mt-4">
    <div class="p-4 shadow-lg rounded bg-light">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>Listado de Vigilantes</h2>
        <button class="btn btn-success" id="btnAgregar">
          <i class="fas fa-plus"></i> Nuevo Vigilante
        </button>
      </div>

      <div class="row mb-3">
        <div class="col-md-6 mb-2">
          <input type="text" id="buscarInput" class="form-control" placeholder="Buscar por nombre o cédula..." />
        </div>
        <div class="col-md-6 text-md-end">
          <button class="btn btn-secondary" id="btnVerTodo">
            <i class="fas fa-list"></i> Ver Todos
          </button>
        </div>
      </div>

      <div class="table-responsive">
        <table class="table table-striped align-middle text-center">
          <thead class="table-dark">
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Cédula</th>
              <th>Teléfono</th>
              <th>Contrato</th>
              <th>RH</th>
              <th>Email</th>
              <th>Supervisor</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tablaVigilantes"></tbody>
        </table>
      </div>

      <nav>
        <ul id="paginacion" class="pagination justify-content-center"></ul>
      </nav>
    </div>
  </main>

  <!-- ============================================================
       MODAL AGREGAR / EDITAR
  ============================================================ -->
  <div class="modal fade" id="vigilanteModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content shadow-lg">
        <div class="modal-header bg-dark text-white">
          <h5 class="modal-title" id="modalTitle">Nuevo Vigilante</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>

        <div class="modal-body">
          <form id="formVigilante" class="p-2">
            <input type="hidden" id="isEdit" value="false" />
            <input type="hidden" id="idVigilantes" />
            <input type="hidden" id="codOperativo" />

            <div class="row gy-3">
              <!-- Nombre -->
              <div class="col-md-8">
                <label class="form-label">Nombre Completo</label>
                <input type="text" id="nombre_apellido" class="form-control" required />
              </div>

              <!-- Cédula -->
              <div class="col-md-4">
                <label class="form-label">Cédula</label>
                <input type="text" id="cedula" class="form-control" maxlength="11" required />
              </div>

              <!-- Correo -->
              <div class="col-md-6">
                <label class="form-label">Correo Electrónico</label>
                <input type="email" id="email" class="form-control" placeholder="ejemplo@correo.com" required />
              </div>

              <!-- Teléfonos -->
              <div class="col-md-3">
                <label class="form-label">Teléfono 1</label>
                <input type="text" id="cel1" class="form-control" maxlength="12" placeholder="Ej: 3104567890" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Teléfono 2</label>
                <input type="text" id="cel2" class="form-control" maxlength="12" placeholder="Opcional" />
              </div>

              <!-- EPS -->
              <div class="col-md-6">
                <label class="form-label">EPS</label>
                <select id="idEPS" class="form-select" required>
                  <option value="">Seleccione una EPS...</option>
                </select>
              </div>

              <!-- ARL -->
              <div class="col-md-6">
                <label class="form-label">ARL</label>
                <select id="idARL" class="form-select" required>
                  <option value="">Seleccione una ARL...</option>
                </select>
              </div>

              <!-- Tipo contrato -->
              <div class="col-md-6">
                <label class="form-label">Tipo de Contrato</label>
                <select id="idTipoContrato" class="form-select" required>
                  <option value="">Seleccione un tipo...</option>
                </select>
              </div>

              <!-- RH -->
              <div class="col-md-3">
                <label class="form-label">RH</label>
                <select id="rh" class="form-select" required>
                  <option value="">Seleccione...</option>
                  <option value="O+">O+</option>
                  <option value="O-">O-</option>
                  <option value="A+">A+</option>
                  <option value="A-">A-</option>
                  <option value="B+">B+</option>
                  <option value="B-">B-</option>
                  <option value="AB+">AB+</option>
                  <option value="AB-">AB-</option>
                </select>
              </div>

              <!-- Estado -->
              <div class="col-md-3">
                <label class="form-label">Estado</label>
                <select id="estado" class="form-select">
                  <option value="Activo" selected>Activo</option>
                  <option value="Inactivo">Inactivo</option>
                </select>
              </div>

              <!-- Supervisor -->
              <div class="col-md-6">
                <label class="form-label">Supervisor</label>
                <select id="idSupervisor" class="form-select" required>
                  <option value="">Seleccione un supervisor...</option>
                </select>
              </div>

              <!-- Fotografía -->
              <div class="col-md-12 text-center">
                <label class="form-label fw-bold mt-2">Fotografía del Vigilante</label>
                <div class="d-flex flex-column align-items-center">
                  <img
                    id="previewFoto"
                    src="../assets/img/user_default.jpg"
                    alt="Foto"
                    class="rounded-circle shadow-sm mb-2"
                    style="width:120px; height:120px; object-fit:cover; border:3px solid #ccc;"
                  />
                  <input type="file" id="fotografia" accept="image/*" class="form-control w-75 mt-1" />
                  <small class="text-muted fst-italic mt-1">Solo JPG o PNG, máx. 2 MB.</small>
                </div>
              </div>
            </div>

            <div class="mt-4 d-flex gap-2 justify-content-end">
              <button type="submit" class="btn btn-success">
                <i class="fas fa-save me-1"></i> Guardar
              </button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                <i class="fas fa-times me-1"></i> Cancelar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>


<!-- ============================================================
     MODAL DETALLES DEL VIGILANTE
============================================================ -->
<div class="modal fade" id="detalleVigilanteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content shadow-lg">
      <div class="modal-header bg-info text-white">
        <h5 class="modal-title">Detalles del Vigilante</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <div class="row gy-3">
          <div class="col-md-4 text-center">
            <img id="detalleFoto"
                 src="../assets/img/user_default.jpg"
                 alt="Foto del vigilante"
                 class="rounded-circle shadow-sm mb-3"
                 style="width:140px;height:140px;object-fit:cover;border:3px solid #ccc;" />
          </div>

          <div class="col-md-8">
            <p><strong>ID:</strong> <span id="detalleId"></span></p>
            <p><strong>Nombre:</strong> <span id="detalleNombre"></span></p>
            <p><strong>Cédula:</strong> <span id="detalleCedula"></span></p>
            <p><strong>Correo:</strong> <span id="detalleEmail"></span></p>
            <p><strong>Teléfono 1:</strong> <span id="detalleCel1"></span></p>
            <p><strong>Teléfono 2:</strong> <span id="detalleCel2"></span></p>
            <p><strong>Tipo de Contrato:</strong> <span id="detalleContrato"></span></p>
            <p><strong>RH:</strong> <span id="detalleRH"></span></p>
            <p><strong>Supervisor:</strong> <span id="detalleSupervisor"></span></p>
            <p><strong>EPS:</strong> <span id="detalleEPS"></span></p>
            <p><strong>ARL:</strong> <span id="detalleARL"></span></p>
            <p><strong>Estado:</strong> <span id="detalleEstado"></span></p>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          <i class="fas fa-times me-1"></i> Cerrar
        </button>
      </div>
    </div>
  </div>
</div>




  <!-- FOOTER -->
  <footer class="main-footer bg-dark text-white mt-5 text-center py-3">
    &copy; 2025 MORLON Seguridad Portuaria Ltda. | Todos los derechos reservados
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script src="../js/seguridad.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    verificarAccesoModulo("Vigilantes", { redirigirSiNo: true });
    bloquearBotonesParaVisitante();
});
</script>



  <script type="module" src="../js/Vigilantes/vigilantes.js"></script>
</body>
</html>
